#### 重绘和回流

> 回流必将引起重绘，重绘不一定引起回流

+ 浏览器渲染机制
  - 浏览器采用流式布局模型。
  - 浏览器会把 HTML 解析成DOM，把 CSS 解析成 CSSOM，DOM 和 CSSOM 相结合产生渲染树。
  - 根据渲染树计算所有节点在页面上的大小和位置，然后把节点绘制到页面上。
  - 由于浏览器使用流式布局，对渲染树的计算通常只需要遍历一次就可以完成。 但是 table 及其内部元素除外，
    他们可能需要多次计算，通常需要花费3倍同等元素的时间，这也是避免使用 table 布局的原因之一。
    
+ 重绘

    > 当元素样式的改变不影响它在文档流中的位置时，浏览器会将新样式赋给元素并重新绘制它，这个过程称为重绘。
    
    - 导致重绘的情况：
      * 修改 DOM
      * 修改样式
      * 用户事件（鼠标悬停、页面滚动、文本框输入文字、改变窗口大小等）
      
+ 回流

    > 当渲染树中部分或全部元素的尺寸、结构或某些属性发生改变时，浏览器重新渲染部分或全部文档的过程称为回流。
        
    - 导致回流的情况：
      * 页面首次渲染
      * 浏览器窗口大小发生改变
      * 元素尺寸或位置发生改变
      * 元素内容发生变化
      * 元素字体大小变化
      * 添加或者删除可见的 DOM 元素
      * 激活 CSS 伪类
      * 查询某些属性或调用某些方法
      
      
> 如何避免回流和重绘
      
 + CSS
   - 避免使用 table 布局
   - 尽可能在 DOM 树的末端改变 class
   - 避免设置多层内联样式
   - 避免使用 CSS 表达式（如：calc）。
   - 将动画效果应用到 position 为 absolute 和 fixed 的元素上。
   
 + JS
   - 避免频繁操作样式
   - 避免频繁操作DOM
   - 先设置 display: none 操作结束后再显示出来，不会引发回流和重绘。
   - 使具有复杂动画的元素脱离文档流，避免父元素及后续元素频繁回流。  